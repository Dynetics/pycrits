import urlparse

from .common import Common
from .access_token import get_access_token,get_api_url
from .vocabulary import CRITs as c
from .vocabulary import CRITsCommon as cc
from .vocabulary import CRITsExploit as exp

class Exploit(Common):
    '''
    
    '''

    _URL = get_api_url() + '/' + c.API + c.VERSION + 'exploits/'

    _fields = [
        exp.ID,
        exp.ACTIONS,
        exp.BUCKET_LIST,
        exp.CAMPAIGN,
        exp.CREATED,
        exp.CVE,
        exp.DESCRIPTION,
        exp.LOCATIONS,
        exp.MODIFIED,
        exp.NAME,
        exp.OBJECTS,
        exp.RELATIONSHIPS,
        exp.RELEASABILITY,
        exp.SCHEMA_VERSION,
        exp.SCREENSHOTS,
        exp.SECTORS,
        exp.SOURCE,
        exp.STATUS,
        exp.TICKETS,
        ]

    # Fields that are REQUIRED to be provided by the user
    # when creating a new object of type EXPLOIT
    _default_fields = [
        exp.NAME,
        exp.SOURCE,
    ]